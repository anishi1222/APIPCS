# プランへのAPIの資格付与

APIをプランの下で使用するには、事前にプランに対してAPIに資格を付与する必要があります。APIへ資格を付与するパスとペルソナがいくつかあります。

## API Manager

API Managerは、プランの下で利用可能になるように、APIへ資格を直接付与したり、APIの資格付与のリクエストを発行したりできます。たとえば、API Managerは、ライフサイクル中で内部のdev/qaプランに直接資格を付与し、その後、消費者に使用されるプランの資格付与のリクエストを発行できます。

## Plan Manager

Plan Managerは、*APIの資格付与*の権限を持っているAPIのリストから選択できます。

## 両方のロールを持つユーザー

一部の企業では、同じ人に両方のロールを持たせることがあります。このような場合は、APIを作成するたびに、*このAPIにデフォルト・プランを作成*チェックボックスを入れることで、プランのステップを省略できます。

## 始める前に

- [プランの作成](../../plans/create_plan)を完了しているか、または既存のプランに対して*資格付与*権限を持っています。
- [API実装の作成](../create_api)を完了しているか、または既存のAPIに対して*APIの資格付与*または*APIの管理*権限を持っています。

## APIにプランへの資格を付与する

### 適切な権限を持っていることを確認

API Managerに、プランに対する資格をAPIに付与するための適切な権限があることを確認してください。必要に応じて*Plan Manager*としてログインし、ユーザーまたはグループがAPIに資格を付与できるようにプランの権限を更新します。

### API Platform Cloud Serviceにログイン

1.選択した環境の説明に従って、ブラウザで管理ポータルのURLを指定します。

> このURLは、選択した[環境](../../../environments/README.md)に基づいています。形式は `http(s)://<host>：<port>/apiplatform`です。

*API Manager*としてログインしてください。

1. *API*を選択し、資格を付与するAPIの名前を選択します。
1. *資格*サイド・タブを選択します。
1. *資格の追加*ボタンをクリックします。
1. 追加するプランを選択し、*追加*ボタンをクリックします。

> 注意：希望のプランがまだ存在しない場合は、[プランの作成](../../plans/create_plan)に従ってプランを作成し、ここに戻ってプランへの資格をAPIに追加できます。

この操作の結果、APIは、プランに対する資格が付与されました。APIが*アクティブ*と*公開済*であることを確認してください（公開する必要があります）。

公開とは、プランに含まれるAPIのリストにAPIが表示されるかどうかを制御するものです。

APIは、アクティブまたは非アクティブにすることができます。 APIが非アクティブの場合、APIは再アクティブ化されるまでプランの下で呼び出すことはできません。これは、アクセスを一時的に無効にするために使用されます。

## 結論

このラボでは、以下の方法を学習しました。

- プランへのAPIの資格付与
- 資格の公開
